<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>附录B、交易脚本语言操作符，常量和符号 | 精通比特币SV</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script data-ad-client="ca-pub-2028497727822047" async="true" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <meta name="description" content="改写自精通比特币第二版，原版权属于原作者">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    
    <link rel="preload" href="/MasterBitcoinSV/assets/css/0.styles.ccf6f871.css" as="style"><link rel="preload" href="/MasterBitcoinSV/assets/js/app.1cc508ac.js" as="script"><link rel="preload" href="/MasterBitcoinSV/assets/js/3.37227c69.js" as="script"><link rel="preload" href="/MasterBitcoinSV/assets/js/19.3d366222.js" as="script"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/10.466ab898.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/11.49136d61.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/12.2e334333.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/13.404c7e9f.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/14.15b90a1f.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/15.4d492ff6.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/16.a25fc06c.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/17.281cda1b.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/18.cd5a8e96.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/20.4da782d1.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/21.7a50fc73.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/22.d8c8068a.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/23.b4051a1e.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/24.0b54f372.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/25.77c62c7f.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/26.7276f704.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/27.8194ac23.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/28.906be128.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/29.487d6557.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/30.e59148dd.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/31.65374195.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/32.1b30d987.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/33.9535960e.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/34.a8d8210d.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/35.bf75033e.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/36.e9dca757.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/37.cf19f129.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/38.d0faccfb.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/39.4ad08d8f.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/4.2f8e84ac.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/40.f102d9f9.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/41.88ac9ca6.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/42.74ff6562.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/43.1c5b3b4c.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/44.84629ca2.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/45.8cb72f7e.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/46.509ca026.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/5.0804d6ab.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/6.411afdf3.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/7.751e9ad2.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/8.f7425502.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/9.e4e96770.js"><link rel="prefetch" href="/MasterBitcoinSV/assets/js/vendors~flowchart.5985ff59.js">
    <link rel="stylesheet" href="/MasterBitcoinSV/assets/css/0.styles.ccf6f871.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/MasterBitcoinSV/" class="home-link router-link-active"><!----> <span class="site-name">精通比特币SV</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/baryon/MasterBitcoinSV" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/baryon/MasterBitcoinSV" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/MasterBitcoinSV/" aria-current="page" class="sidebar-link">精通比特币SV</a></li><li><a href="/MasterBitcoinSV/glossary.html" class="sidebar-link">词汇表</a></li><li><a href="/MasterBitcoinSV/ch01.html" class="sidebar-link">第1章 介绍</a></li><li><a href="/MasterBitcoinSV/ch02.html" class="sidebar-link">第2章 比特币工作原理</a></li><li><a href="/MasterBitcoinSV/ch03.html" class="sidebar-link">第3章 Bitcoin SV</a></li><li><a href="/MasterBitcoinSV/ch04.html" class="sidebar-link">第4章 密钥和地址</a></li><li><a href="/MasterBitcoinSV/ch05.html" class="sidebar-link">第5章 钱包</a></li><li><a href="/MasterBitcoinSV/ch05a.html" class="sidebar-link">第5章 补充</a></li><li><a href="/MasterBitcoinSV/ch06.html" class="sidebar-link">第6章 交易</a></li><li><a href="/MasterBitcoinSV/ch06a.html" class="sidebar-link">第6章 补充</a></li><li><a href="/MasterBitcoinSV/ch07.html" class="sidebar-link">第7章 高级交易和脚本</a></li><li><a href="/MasterBitcoinSV/ch08.html" class="sidebar-link">第8章 比特币网络</a></li><li><a href="/MasterBitcoinSV/ch09.html" class="sidebar-link">第9章 区块链</a></li><li><a href="/MasterBitcoinSV/ch10.html" class="sidebar-link">第10章 挖矿和共识</a></li><li><a href="/MasterBitcoinSV/ch11.html" class="sidebar-link">第11章 比特币安全</a></li><li><a href="/MasterBitcoinSV/ch12.html" class="sidebar-link">第12章 区块链应用</a></li><li><a href="/MasterBitcoinSV/appdx-bitcoinwhitepaper.html" class="sidebar-link">附录A-1、比特币白皮书：一种点对点的电子现金系统</a></li><li><a href="/MasterBitcoinSV/bitcoin-whitepaper-cn.html" class="sidebar-link">附录A-2、比特币白皮书（李笑来中英文对照版）</a></li><li><a href="/MasterBitcoinSV/appdx-scriptops.html" aria-current="page" class="active sidebar-link">附录B、交易脚本语言操作符，常量和符号</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#常量" class="sidebar-link">常量</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#程序流控制操作符" class="sidebar-link">程序流控制操作符</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#堆栈操作符" class="sidebar-link">堆栈操作符</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#字符串操作" class="sidebar-link">字符串操作</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#二进制算术和条件" class="sidebar-link">二进制算术和条件</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#数值操作" class="sidebar-link">数值操作</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#加密和哈希操作" class="sidebar-link">加密和哈希操作</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#用过的nop操作符" class="sidebar-link">用过的NOP操作符</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#伪关键词" class="sidebar-link">伪关键词</a></li><li class="sidebar-sub-header"><a href="/MasterBitcoinSV/appdx-scriptops.html#保留操作符" class="sidebar-link">保留操作符</a></li></ul></li><li><a href="/MasterBitcoinSV/appdx-bips.html" class="sidebar-link">附录C、比特币改进提案（BIPs）</a></li><li><a href="/MasterBitcoinSV/appdx-bitcore.html" class="sidebar-link">附录D Bitcore</a></li><li><a href="/MasterBitcoinSV/appdx-pycoin.html" class="sidebar-link">附录E、pycoin</a></li><li><a href="/MasterBitcoinSV/appdx-bx.html" class="sidebar-link">附录F、比特币浏览器命令</a></li><li><a href="/MasterBitcoinSV/second_edition_changes.html" class="sidebar-link">第二版更新内容</a></li><li><a href="/MasterBitcoinSV/README-ytm2nd.html" class="sidebar-link">精通比特币第二版中文翻译开篇</a></li><li><a href="/MasterBitcoinSV/preface.html" class="sidebar-link">原版序言</a></li><li><a href="/MasterBitcoinSV/cn-preface.html" class="sidebar-link">中文版序言</a></li><li><a href="/MasterBitcoinSV/trans-preface.html" class="sidebar-link">译者序</a></li><li><a href="/MasterBitcoinSV/SUMMARY.html" class="sidebar-link">总结</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="附录b、交易脚本语言操作符-常量和符号"><a href="#附录b、交易脚本语言操作符-常量和符号" class="header-anchor">#</a> 附录B、交易脚本语言操作符，常量和符号</h1> <blockquote><p>原内容来源于<a href="https://wiki.bitcoinsv.io/index.php/Opcodes_used_in_Bitcoin_Script" target="_blank" rel="noopener noreferrer">Opcodes used in Bitcoin Script - Bitcoin Wiki<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 和<a href="https://en.bitcoin.it/wiki/Script" target="_blank" rel="noopener noreferrer">Script - Bitcoin Wiki<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 基于CC 3.0 做了修订和更新。中文翻译来自<a href="https://github.com/tianmingyun/MasterBitcoin2CN/blob/master/appdx-scriptops.md" target="_blank" rel="noopener noreferrer">MasterBitcoin2CN-appdx-scriptops<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 基于 CC BY-SA 4.0 做了修订和更新</p></blockquote> <p>这里是所有 比特币脚本操作符，也称为关键词、命令或函数。False 是零或负零(使用了任意数量的字节)或空数组，而 True 是其他任何东西。</p> <h2 id="常量"><a href="#常量" class="header-anchor">#</a> 常量</h2> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>输入</th> <th>输出</th> <th>描述</th></tr></thead> <tbody><tr><td>OP_0 or OP_FALSE</td> <td>0x00</td> <td>Nothing</td> <td>(empty value)</td> <td>把一个空的字节压入堆栈</td></tr> <tr><td>1-75</td> <td>0x01-0x4b</td> <td>(special)</td> <td>data</td> <td>把接下来的N 个字节压入堆栈中，N 的取值在1 到75 之间</td></tr> <tr><td>OP_PUSHDATA1</td> <td>0x4c</td> <td>(special)</td> <td>data</td> <td>下一个字节包括数字N，会将接下来的N 个字节压入堆栈</td></tr> <tr><td>OP_PUSHDATA2</td> <td>0x4d</td> <td>(special)</td> <td>data</td> <td>下面两个字节包括数字N，会将接下来的N 个字节压入堆栈</td></tr> <tr><td>OP_PUSHDATA4</td> <td>0x4e</td> <td>(special)</td> <td>data</td> <td>下面四个字节包括数字N，会将接下来的N 个字节压入堆栈</td></tr> <tr><td>OP_1NEGATE</td> <td>0x4f</td> <td>Nothing</td> <td>-1</td> <td>将数字-1 压入堆栈</td></tr> <tr><td>OP_1 or OP_TRUE</td> <td>0x51</td> <td>Nothing</td> <td>1</td> <td>将数字1 压入堆栈</td></tr> <tr><td>OP_2 to OP_16</td> <td>0x52 to 0x60</td> <td>Nothing</td> <td>2-16</td> <td>将数字N 压入堆栈，例如OP_2 压入数字2</td></tr></tbody></table> <h2 id="程序流控制操作符"><a href="#程序流控制操作符" class="header-anchor">#</a> 程序流控制操作符</h2> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>输入</th> <th>输出</th> <th>描述</th></tr></thead> <tbody><tr><td>OP_NOP</td> <td>0x61</td> <td>Nothing</td> <td>Nothing</td> <td>无操作</td></tr> <tr><td>OP_VER</td> <td>0x62</td> <td>Nothing</td> <td>Protocol version</td> <td>将此事务所依据的协议版本放到堆栈上。(此操作码计划在Chronicle版本中重新启用)</td></tr> <tr><td>OP_IF</td> <td>0x63</td> <td></td> <td></td> <td>如果栈项元素值不为FALSE，在IF和ELSE之间的语句将被执行。如果如果栈项元素值为FALSE，在ELSE和ENDIF之间的语句将被执行。栈顶元素被删除。 IF [statements&gt;ELSE [statements]ENDIF</td></tr> <tr><td>OP_NOTIF</td> <td>0x64</td> <td></td> <td></td> <td>如果栈项元素值为FALSE，在IF和ELSE之间的语句将被执行。如果如果栈项元素值不为FALSE，在ELSE和ENDIF之间的语句将被执行。栈顶元素被删除。 IF [statements&gt;ELSE [statements]ENDIF</td></tr> <tr><td>OP_VERIF</td> <td>0x65</td> <td></td> <td></td> <td>如果栈项元素值等于交易执行时的协议版本，在IF和ELSE之间的语句将被执行。如果如果栈项元素值不等于交易执行时的协议版本，在ELSE和ENDIF之间的语句将被执行。栈顶元素被删除。(此操作码计划在Chronicle版本中重新启用)  IF [statements&gt;ELSE [statements]ENDIF</td></tr> <tr><td>OP_VERNOTIF</td> <td>0x66</td> <td></td> <td></td> <td>如果栈项元素值不等于交易执行时的协议版本，在IF和ELSE之间的语句将被执行。如果如果栈项元素值等于交易执行时的协议版本，在ELSE和ENDIF之间的语句将被执行。栈顶元素被删除。(此操作码计划在Chronicle版本中重新启用) IF [statements&gt;ELSE [statements]ENDIF</td></tr> <tr><td>OP_ELSE</td> <td>0x67</td> <td></td> <td></td> <td>如果前述的OP_IF 或OP_NOTIF 或OP_ELSE 未被执行，这些语句就会被执行</td></tr> <tr><td>OP_ENDIF</td> <td>0x68</td> <td></td> <td></td> <td>终止OP_IF, OP_NOTIF, OP_ELSE 区块</td></tr> <tr><td>OP_VERIFY</td> <td>0x69</td> <td>True / False</td> <td>Nothing / Fail</td> <td>如果栈项元素值非真，则标记交易无效。栈顶元素被删除。</td></tr> <tr><td>OP_RETURN</td> <td>0x6a</td> <td>Nothing</td> <td>结束脚本。栈顶元素是脚本最终结果</td> <td>OP_ Return 还可用于创建“ False Return”输出，其中 scriptPubKey 由 OP_FALE OP _RETURN 和数据组成。这样的输出是不可花费的，并且应该给出一个零Satoshi值。可以从 UTXO数据集存储中删除这些输出，从而减小大小。目前BitcoinSV 网络支持在给定交易中包含多个 FALSE RETURN 输出，最初每个输出可以容纳100KB 的数据。在2020年创世升级之后，根据矿工的设置可包含任何大小的数据。</td></tr></tbody></table> <h2 id="堆栈操作符"><a href="#堆栈操作符" class="header-anchor">#</a> 堆栈操作符</h2> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>输入</th> <th>输出</th> <th>描述</th></tr></thead> <tbody><tr><td>OP_TOALTSTACK</td> <td>0x6b</td> <td>x1</td> <td>(alt)x1</td> <td>从主堆栈中取出元素，推入辅堆栈。</td></tr> <tr><td>OP_FROMALTSTACK</td> <td>0x6c</td> <td>(alt)x1</td> <td>x1</td> <td>从辅堆栈中取出元素，推入主堆栈</td></tr> <tr><td>OP_2DROP</td> <td>0x6d</td> <td>x1 x2</td> <td>Nothing</td> <td>移除栈顶两个元素</td></tr> <tr><td>OP_2DUP</td> <td>0x6e</td> <td>x1 x2</td> <td>x1 x2 x1 x2</td> <td>复制栈顶两个元素</td></tr> <tr><td>OP_3DUP</td> <td>0x6f</td> <td>x1 x2 x3</td> <td>x1 x2 x3 x1 x2 x3</td> <td>复制栈顶三个元素</td></tr> <tr><td>OP_2OVER</td> <td>0x70</td> <td>x1 x2 x3 x4</td> <td>x1 x2 x3 x4 x1 x2</td> <td>把栈底的第三、第四个元素拷贝到栈顶</td></tr> <tr><td>OP_2ROT</td> <td>0x71</td> <td>x1 x2 x3 x4 x5 x6</td> <td>x3 x4 x5 x6 x1 x2</td> <td>移动第五、第六元素到栈顶</td></tr> <tr><td>OP_2SWAP</td> <td>0x72</td> <td>x1 x2 x3 x4</td> <td>x3 x4 x1 x2</td> <td>将栈顶的两个元素进行交换</td></tr> <tr><td>OP_IFDUP</td> <td>0x73</td> <td>x</td> <td>x / x x</td> <td>如果栈项元素值不为0，复制该元素值</td></tr> <tr><td>OP_DEPTH</td> <td>0x74</td> <td>Nothing</td> <td>Stack size</td> <td>计算堆栈元素的数量，并将值放置在堆栈顶部</td></tr> <tr><td>OP_DROP</td> <td>0x75</td> <td>x</td> <td>Nothing</td> <td>删除栈顶元素</td></tr> <tr><td>OP_DUP</td> <td>0x76</td> <td>x</td> <td>x x</td> <td>复制栈顶元素</td></tr> <tr><td>OP_NIP</td> <td>0x77</td> <td>x1 x2</td> <td>x2</td> <td>删除栈顶的下一个元素</td></tr> <tr><td>OP_OVER</td> <td>0x78</td> <td>x1 x2</td> <td>x1 x2 x1</td> <td>复制栈顶的下一个元素到栈顶</td></tr> <tr><td>OP_PICK</td> <td>0x79</td> <td>xn ... x2 x1 x0 n</td> <td>xn ... x2 x1 x0 xn</td> <td>把堆栈的第n 个元素拷贝到栈顶</td></tr> <tr><td>OP_ROLL</td> <td>0x7a</td> <td>xn ... x2 x1 x0 n</td> <td>... x2 x1 x0 xn</td> <td>把堆栈的第n 个元素移动到栈顶</td></tr> <tr><td>OP_ROT</td> <td>0x7b</td> <td>x1 x2 x3</td> <td>x2 x3 x1</td> <td>翻转栈顶的三个元素</td></tr> <tr><td>OP_SWAP</td> <td>0x7c</td> <td>x1 x2</td> <td>x2 x1</td> <td>栈顶的三个元素交换</td></tr> <tr><td>OP_TUCK</td> <td>0x7d</td> <td>x1 x2</td> <td>x2 x1 x2</td> <td>拷贝栈顶元素并插入到栈顶第二个元素之后</td></tr></tbody></table> <h2 id="字符串操作"><a href="#字符串操作" class="header-anchor">#</a> 字符串操作</h2> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>输入</th> <th>输出</th> <th>描述</th></tr></thead> <tbody><tr><td><em>OP_CAT</em></td> <td>0x7e</td> <td>x1 x2</td> <td>out</td> <td>连接两个字符串</td></tr> <tr><td><em>OP_SPLIT</em></td> <td>0x7f</td> <td>x n</td> <td>x1 x2</td> <td>在位置 n 处拆分字节序列 x</td></tr> <tr><td><em>OP_NUM2BIN</em></td> <td>0x80</td> <td>a b</td> <td>out</td> <td>将数值 a 转换为长度为 b 的字节序列</td></tr> <tr><td><em>OP_BIN2NUM</em></td> <td>0x81</td> <td>x</td> <td>out</td> <td>将字节序列 x 转换为数值</td></tr> <tr><td>OP_SIZE</td> <td>0x82</td> <td>in</td> <td>in size</td> <td>把栈顶元素的字符串长度压入堆栈（原字符串不出栈）</td></tr></tbody></table> <h2 id="二进制算术和条件"><a href="#二进制算术和条件" class="header-anchor">#</a> 二进制算术和条件</h2> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>输入</th> <th>输出</th> <th>描述</th></tr></thead> <tbody><tr><td><em>OP_INVERT</em></td> <td>0x83</td> <td>in</td> <td>out</td> <td>所有输入的位取反，已禁用</td></tr> <tr><td><em>OP_AND</em></td> <td>0x84</td> <td>x1 x2</td> <td>out</td> <td>对输入的所有位进行布尔与运算，已禁用</td></tr> <tr><td><em>OP_OR</em></td> <td>0x85</td> <td>x1 x2</td> <td>out</td> <td>对输入的每一位进行布尔或运算，已禁用</td></tr> <tr><td><em>OP_XOR</em></td> <td>0x86</td> <td>x1 x2</td> <td>out</td> <td>对输入的每一位进行布尔异或运算，已禁用</td></tr> <tr><td>OP_EQUAL</td> <td>0x87</td> <td>x1 x2</td> <td>True / false</td> <td>如果输入的两个数相等，返回1，否则返回0</td></tr> <tr><td>OP_EQUALVERIFY</td> <td>0x88</td> <td>x1 x2</td> <td>Nothing / fail</td> <td>与OP_EQUAL 一样，如结果为0，之后运行OP_VERIFY</td></tr></tbody></table> <h2 id="数值操作"><a href="#数值操作" class="header-anchor">#</a> 数值操作</h2> <p>注意: 算术输入仅限于有符号的32位整数，但可能会溢出。如果这些命令的任何输入值超过4字节，脚本必须中止并失败。</p> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>输入</th> <th>输出</th> <th>描述</th></tr></thead> <tbody><tr><td>OP_1ADD</td> <td>0x8b</td> <td>in</td> <td>out</td> <td>栈顶值加1</td></tr> <tr><td>OP_1SUB</td> <td>0x8c</td> <td>in</td> <td>out</td> <td>栈顶值减1</td></tr> <tr><td><em>OP_2MUL</em></td> <td>0x8d</td> <td>in</td> <td>out</td> <td>栈顶值乘2(此操作码计划在Chronicle版本中重新启用)</td></tr> <tr><td><em>OP_2DIV</em></td> <td>0x8e</td> <td>in</td> <td>out</td> <td>栈顶值除2(此操作码计划在Chronicle版本中重新启用)</td></tr> <tr><td>OP_NEGATE</td> <td>0x8f</td> <td>in</td> <td>out</td> <td>栈顶值符号取反</td></tr> <tr><td>OP_ABS</td> <td>0x90</td> <td>in</td> <td>out</td> <td>栈顶值符号取正</td></tr> <tr><td>OP_NOT</td> <td>0x91</td> <td>in</td> <td>out</td> <td>如果栈顶值为0 或1，则输出1或0；否则输出0</td></tr> <tr><td>OP_0NOTEQUAL</td> <td>0x92</td> <td>in</td> <td>out</td> <td>输入值为0 输出0；否则输出1</td></tr> <tr><td>OP_ADD</td> <td>0x93</td> <td>a b</td> <td>out</td> <td>弹出栈顶的两个元素，压入二者相加结果 b+a</td></tr> <tr><td>OP_SUB</td> <td>0x94</td> <td>a b</td> <td>out</td> <td>弹出栈顶的两个元素，压入二者相减（第二项减去第一项）结果 b-a</td></tr> <tr><td>OP_MUL</td> <td>0x95</td> <td>a b</td> <td>out</td> <td>栈顶两项的积</td></tr> <tr><td>OP_DIV</td> <td>0x96</td> <td>a b</td> <td>out</td> <td>输出用第二项除以第一项的倍数</td></tr> <tr><td>OP_MOD</td> <td>0x97</td> <td>a b</td> <td>out</td> <td>输出用第二项除以第一项得到的余数</td></tr> <tr><td>OP_LSHIFT</td> <td>0x98</td> <td>a b</td> <td>out</td> <td>左移第二项，移动位数为第一项的二进制位数, 无视符号</td></tr> <tr><td>OP_RSHIFT</td> <td>0x99</td> <td>a b</td> <td>out</td> <td>右移第二项，移动位数为第一项的二进制位数,无视符号</td></tr> <tr><td>OP_BOOLAND</td> <td>0x9a</td> <td>a b</td> <td>out</td> <td>布尔与运算，两项都不为0，输出1，否则输出0</td></tr> <tr><td>OP_BOOLOR</td> <td>0x9b</td> <td>a b</td> <td>out</td> <td>布尔或运算，两项有一个不为0，输出1，否则输出0</td></tr> <tr><td>OP_NUMEQUAL</td> <td>0x9c</td> <td>a b</td> <td>out</td> <td>两项相等则输出1，否则输出为0</td></tr> <tr><td>OP_NUMEQUALVERIFY</td> <td>0x9d</td> <td>a b</td> <td>Nothing / fail</td> <td>与NUMEQUAL 相同，如结果为0， 运行OP_VERIFY</td></tr> <tr><td>OP_NUMNOTEQUAL</td> <td>0x9e</td> <td>a b</td> <td>out</td> <td>如果栈顶两项不是相等数的话，则输出1，否则输出为0</td></tr> <tr><td>OP_LESSTHAN</td> <td>0x9f</td> <td>a b</td> <td>out</td> <td>如果栈顶数第二项小于栈顶项，则输出1，否则输出为0  a&lt;b</td></tr> <tr><td>OP_GREATERTHAN</td> <td>0xa0</td> <td>a b</td> <td>out</td> <td>如果栈顶数第二项大于栈顶项，则输出1 a&gt;b</td></tr> <tr><td>OP_LESSTHANOREQUAL</td> <td>0xa1</td> <td>a b</td> <td>out</td> <td>如果栈顶数第二项小于或等于第一项，则输出1 a&lt;=b</td></tr> <tr><td>OP_GREATERTHANOREQUAL</td> <td>0xa2</td> <td>a b</td> <td>out</td> <td>如果栈顶数第二项大于或等于第一项，则输出1 a&gt;=b</td></tr> <tr><td>OP_MIN</td> <td>0xa3</td> <td>a b</td> <td>out</td> <td>输出栈顶两项中较小的一项</td></tr> <tr><td>OP_MAX</td> <td>0xa4</td> <td>a b</td> <td>out</td> <td>输出栈顶两项中较大的一项</td></tr> <tr><td>OP_WITHIN</td> <td>0xa5</td> <td>a b</td> <td>out</td> <td>如果第三项的数值介于前两项之间，则输出1，否则输出为0</td></tr></tbody></table> <h2 id="加密和哈希操作"><a href="#加密和哈希操作" class="header-anchor">#</a> 加密和哈希操作</h2> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>输入</th> <th>输出</th> <th>描述</th></tr></thead> <tbody><tr><td>OP_RIPEMD160</td> <td>0xa6</td> <td>in</td> <td>hash</td> <td>返回栈顶元素的RIPEMD160 哈希值</td></tr> <tr><td>OP_SHA1</td> <td>0xa7</td> <td>in</td> <td>hash</td> <td>返回栈顶元素SHA1 哈希值</td></tr> <tr><td>OP_SHA256</td> <td>0xa8</td> <td>in</td> <td>hash</td> <td>返回栈顶元素SHA256 哈希值</td></tr> <tr><td>OP_HASH160</td> <td>0xa9</td> <td>in</td> <td>hash</td> <td>栈顶元素进行两次HASH，先用SHA-256，再用RIPEMD-160</td></tr> <tr><td>OP_HASH256</td> <td>0xaa</td> <td>in</td> <td>hash</td> <td>栈顶元素用SHA-256 算法HASH 两次</td></tr> <tr><td>OP_CODESEPARATOR</td> <td>0xab</td> <td>Nothing</td> <td>Nothing</td> <td>标记已进行签名验证的数据。All of the signature checking words will only match signatures to the data after the most recently-executed OP_CODESEPARATOR.</td></tr> <tr><td>OP_CHECKSIG</td> <td>0xac</td> <td>sig pubkey</td> <td>True / false</td> <td>交易用的签名必须是哈希值和公钥的有效签名，如果为真，则返回1，否则为0。整个事务的输出、输入和脚本(从最近执行的 op_codeseparator 到最后)都取哈希值。Op_checksig 使用的签名必须是此哈希值。</td></tr> <tr><td>OP_CHECKSIGVERIFY</td> <td>0xad</td> <td>sig pubkey</td> <td>Nothing / fail</td> <td>与CHECKSIG 一样，但之后运行OP_VERIFY, 栈顶元素移除。</td></tr> <tr><td>OP_CHECKMULTISIG</td> <td>0xae</td> <td>x sig1 sig2 ... number of signatures pub1 pub2 number of public keys</td> <td>True / False</td> <td>对于每对签名和公钥运行CHECKSIG。所有的签名要与公钥匹配。实现中存在一个BUG，会从堆栈中弹出一个前缀为OP_0的值。如果公钥无法进行任何签名比较，就不会再次检查它们，所以必须使用与它们相应的公钥在 scriptPubKey 或 redeemScript 中相同的顺序将签名放在 scriptSig 中。如果所有签名都有效，则返回1，否则返回0。</td></tr> <tr><td>OP_CHECKMULTISIGVERIFY</td> <td>0xaf</td> <td>x sig1 sig2 ... number of signatures pub1 pub2 ... number of public keys</td> <td>Nothing / fail</td> <td>与CHECKMULTISIG 一样，但之后运行OP_VERIFY</td></tr></tbody></table> <h2 id="用过的nop操作符"><a href="#用过的nop操作符" class="header-anchor">#</a> 用过的NOP操作符</h2> <p>在比特币的历史上，有操作码使用过保留的 NO_NOP 操作码标识符。现在这些操作码已经恢复到最初的无操作功能。</p> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>输入</th> <th>输出</th> <th>描述</th></tr></thead> <tbody><tr><td>OP_NOP2(之前是OP_CHECKLOCKTIMEVERIFY)</td> <td>0xb1</td> <td>Nothing(之前是 x)</td> <td>Nothing(之前是 x或fail)</td> <td>无操作忽略 （ 之前的语义在 bip0065中进行了描述）</td></tr> <tr><td>OP_NOP3(之前是 OP_CHECKSEQUENCEVERIFY)</td> <td>0xb2</td> <td>Nothing(之前是 x)</td> <td>Nothing(之前是 x或fail)</td> <td>无操作忽略（ 之前的语义在 bip0112中进行了描述）</td></tr></tbody></table> <h2 id="伪关键词"><a href="#伪关键词" class="header-anchor">#</a> 伪关键词</h2> <p>这些关键词在内部用于协助交易匹配。如果在实际脚本中使用它们则无效。</p> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>描述</th></tr></thead> <tbody><tr><td>OP_PUBKEYHASH</td> <td>0xfd</td> <td>表示OP_HASH160哈希的公钥</td></tr> <tr><td>OP_PUBKEY</td> <td>0xfe</td> <td>表示与OP_CHECKSIG兼容的公钥</td></tr> <tr><td>OP_INVALIDOPCODE</td> <td>0xff</td> <td>代表当前未指定的操作码</td></tr></tbody></table> <h2 id="保留操作符"><a href="#保留操作符" class="header-anchor">#</a> 保留操作符</h2> <p>未分配的任何操作码也被保留。使用未分配的操作码会导致交易无效。</p> <table><thead><tr><th>符号</th> <th>值 (十六进制)</th> <th>描述</th></tr></thead> <tbody><tr><td>OP_RESERVED</td> <td>0x50</td> <td>除非放在未执行的 OP_IF 分支中，否则交易无效</td></tr> <tr><td>OP_RESERVED1</td> <td>0x89</td> <td>除非放在未执行的 OP_IF 分支中，否则交易无效</td></tr> <tr><td>OP_RESERVED2</td> <td>0x8a</td> <td>除非放在未执行的 OP_IF 分支中，否则交易无效</td></tr> <tr><td>OP_NOP1, OP_NOP4-OP_NOP10</td> <td>0xb0, 0xb3-0xb9</td> <td>忽略该操作符。不将交易标记为无效。</td></tr></tbody></table> <h6 id=""><a href="#" class="header-anchor">#</a></h6></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/baryon/MasterBitcoinSV/edit/master/src/appdx-scriptops.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/MasterBitcoinSV/bitcoin-whitepaper-cn.html" class="prev">
        附录A-2、比特币白皮书（李笑来中英文对照版）
      </a></span> <span class="next"><a href="/MasterBitcoinSV/appdx-bips.html">
        附录C、比特币改进提案（BIPs）
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/MasterBitcoinSV/assets/js/app.1cc508ac.js" defer></script><script src="/MasterBitcoinSV/assets/js/3.37227c69.js" defer></script><script src="/MasterBitcoinSV/assets/js/19.3d366222.js" defer></script>
  </body>
</html>
